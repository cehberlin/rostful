# tox.ini , put in same dir as setup.py
[tox]

envlist =

  # testing 2.7 with any distro's packages
  py27-ros-{indigo,kinetic,lunar,latest},

  # testing obsolete python3 version only with the matching distro packages
  py34-ros-indigo,
  py35-ros-kinetic,

  # testing latest python3 with any distro's packages
  py36-ros-{indigo,kinetic,lunar,latest}

#, pypy
#, pypy3

[travis]
python =
  2.7 : py27
  3.4 : py34
  3.5 : py35
  3.6 : py36

# not tested yet
#pypy = pypy
#pypy3 = pypy3

# We depend on travis matrix
[travis:env]
ROS_DISTRO =
  kinetic: kinetic
  indigo: indigo
  lunar: lunar
  latest: latest

[testenv]

# Dependencies matching the version in each ROS distro
deps =
    # TODO : check why / how install_requires are installed or not in tox environments...

    indigo: -rrequirements/indigo.txt

    kinetic: -rrequirements/kinetic.txt

    lunar: -rrequirements/lunar.txt

    latest: -rrequirements/latest.txt

# to always force recreation and avoid unexpected side effects
recreate=True

commands=
    # we want to make sure python finds the installed package in tox env
    # and doesn't confuse with pyc generated during dev (which happens if we use self test feature here)
    python -m pytest --pyargs rostful.tests {posargs}
    # Note : -s here might break your terminal...
